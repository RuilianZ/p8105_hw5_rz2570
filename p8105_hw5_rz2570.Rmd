---
title: "p8105_hw5"
author: "Ruilian Zhang"
date: "11/12/2021"
output: github_document
---

```{r}
library(tidyverse)
```


## Problem 1

```{r import and summary data}
homicide_df = read_csv("data/homicide-data.csv") %>% 
  janitor::clean_names() %>% 
  mutate(city_state = str_c(city, state, sep = ", "))

n_homicides_df = homicide_df %>% 
  group_by(city_state) %>% 
  summarize(
    n_homicides = n()
  )

n_unsolved_df = homicide_df %>% 
  group_by(city_state) %>% 
  filter(disposition %in% c("Closed without arrest", "Open/No arrest")) %>% 
  summarize(
    n_unsolved = n()
  )

left_join(n_homicides_df, n_unsolved_df, by = "city_state") %>% 
  mutate(n_unsolved = replace_na(n_unsolved, 0)) %>% 
  knitr::kable()
```

```{r prop test}
baltimore_prop = prop.test(c(1825, 1002), n = c(2827, 2827), alternative = "two.sided")

baltimore_prop_tidy = broom::tidy(baltimore_prop, conf.int = TRUE)

pull(baltimore_prop_tidy, estimate1)
c(pull(baltimore_prop_tidy, conf.low), pull(baltimore_prop_tidy, conf.high))
```

For unsolved homicides in Baltimore, the estimated proportion is `r pull(baltimore_prop_tidy, estimate1)`. The confidence interval is (`r c(pull(baltimore_prop_tidy, conf.low), pull(baltimore_prop_tidy, conf.high))`).
